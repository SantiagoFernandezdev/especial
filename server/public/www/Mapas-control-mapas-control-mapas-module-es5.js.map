{"version":3,"sources":["webpack:///src/app/pages/Mapas/control-mapas/control-mapas-routing.module.ts","webpack:///src/app/pages/Mapas/control-mapas/control-mapas.module.ts","webpack:///src/app/pages/Mapas/control-mapas/control-mapas.page.ts","webpack:///src/app/pages/Mapas/control-mapas/control-mapas.page.html"],"names":["routes","path","component","ControlMapasPageRoutingModule","forChild","imports","exports","ControlMapasPageModule","entryComponents","declarations","ControlMapasPage","almacenamiento","alertCtrl","apiMapas","apiUsuario","toastService","geoReferencia","modalCtrl","popover","loading","cargando","negocios","paises","ciudades","pais","paiss","miciudad","escogidos","ciudad","sedes","imagen","lat","lng","mensaje","draggable","listarPaises","listarNegocios","llamarFoto","create","message","spinner","present","console","log","getCurrentPosition","enableHighAccuracy","data","coords","latitude","longitude","traerSedes","toastError","obtenerToken","info","viewImagen","token","subscribe","url","paquete","calcular","error","mapboxgl","accessToken","mapa","Map","container","nativeElement","style","center","zoom","addControl","NavigationControl","el","document","createElement","className","backgroundImage","backgroundSize","width","height","marker","Marker","element","setLngLat","addTo","forEach","sede","creador","length","miSede","markerSede","ubicacion","addEventListener","miModal","dismiss","buscarSedes","filtros","response","graficar","err","exe","item","checked","push","event","opt","detail","value","nombre","listarCiudades","_id","vista","componentProps","modal","evet","popov","onWillDismiss","res","arreglo","filtrar","selector","templateUrl","styleUrls"],"mappings":"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","file":"Mapas-control-mapas-control-mapas-module-es5.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { ControlMapasPage } from './control-mapas.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: ControlMapasPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class ControlMapasPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { ControlMapasPageRoutingModule } from './control-mapas-routing.module';\n\nimport { ControlMapasPage } from './control-mapas.page';\nimport { ModalMapasPage } from '../modal-mapas/modal-mapas.page';\nimport { ModalMapasPageModule } from '../modal-mapas/modal-mapas.module';\n\n@NgModule({\n  entryComponents: [\n    ModalMapasPage\n  ],\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    ControlMapasPageRoutingModule,\n    ModalMapasPageModule\n  ],\n  declarations: [ControlMapasPage]\n})\nexport class ControlMapasPageModule {}\n","import { Component, ElementRef, OnInit, ViewChild } from '@angular/core';\nimport { Geolocation } from '@ionic-native/geolocation/ngx';\nimport { AlertController, LoadingController, ModalController, PopoverController } from '@ionic/angular';\nimport { InicioService } from 'src/app/providers/Almacenamiento/inicio.service';\nimport { UsuariosLoginService } from 'src/app/providers/Api/UsuariosLogin.service';\nimport { MapasService } from '../../../providers/Api/Mapar.service';\nimport { ToastServices } from '../../../providers/Utilidades/ToastService.service';\nimport { ModalMapasPage } from '../modal-mapas/modal-mapas.page';\ndeclare var mapboxgl;\n\n@Component({\n  selector: 'app-control-mapas',\n  templateUrl: './control-mapas.page.html',\n  styleUrls: ['./control-mapas.page.scss'],\n})\nexport class ControlMapasPage implements OnInit {\n\n  cargando = false;\n  negocios = [];\n  paises = [];\n  ciudades = [];\n  pais = '';\n  paiss = '';\n  miciudad = '';\n  escogidos = [];\n\n  ciudad = false;\n  sedes = [];\n\n  imagen = '';\n  lat = 0;\n  lng = 0;\n\n  mensaje = '';\n  draggable = false;\n\n\n  \n  @ViewChild('mapa') mapa: ElementRef;\n  constructor(\n    private almacenamiento: InicioService,\n    private alertCtrl: AlertController,\n    private apiMapas: MapasService,\n    private apiUsuario: UsuariosLoginService,\n    private toastService: ToastServices,\n    private geoReferencia: Geolocation,\n    private modalCtrl: ModalController,\n    private popover: PopoverController,\n    private loading: LoadingController\n  ) { }\n\n  ngOnInit() {\n  }\n\n ionViewWillEnter() {\n  this.listarPaises();\n  this.listarNegocios();\n  //this.traerSedes();\n  this.llamarFoto();\n  //this.calcular();\n }\n\n  \n async calcular() {\n   \n  try {\n    const loading = await this.loading.create({\n      message: 'Cargando Mapa...',\n     spinner: 'circles'\n    })\n    await loading.present();\n    console.log('entramos al click')\n    const data = await this.geoReferencia.getCurrentPosition({enableHighAccuracy: true});\n\n    if ( data ) {\n    console.log(data);\n    this.lat = data.coords.latitude;\n    this.lng = data.coords.longitude;\n    // this.graficar();\n    this.traerSedes();\n  }\n  } catch (error) {\n    console.log(error, 'ERROR GEOLOCATION');\n    this.toastService.toastError(error);\n  }\n}\n\n\nasync llamarFoto() {\n\nconst info = await this.almacenamiento.obtenerToken();\n\nif ( info ) {\n  this.apiUsuario.viewImagen(info.token).subscribe((url: any) => {\n    // // console.log(url);\n    this.imagen = `https://motocaliapp.com/${url.paquete}`;\n    console.log(this.imagen)\n    this.calcular();\n  }, (error) => {\n    // // console.log(error);\n  })\n}\n    \n  }\n\ngraficar() {\n  console.log('Bien');\n  mapboxgl.accessToken = 'pk.eyJ1Ijoic2FudGlhZ29mZXJuYW5kZXpkZXYiLCJhIjoiY2tmYmh6cXdzMDM0bDJ2cHRucTI4cHpkaSJ9.-01EYvsLdJOU1Oy4BtwBwA';\n  const mapa = new mapboxgl.Map({\n  container: this.mapa.nativeElement,\n  style: 'mapbox://styles/mapbox/streets-v11',\n  center: [this.lng, this.lat],\n  zoom: 11\n  });\n\n  mapa.addControl(new mapboxgl.NavigationControl());\n\n  const el = document.createElement('div'); \n  el.className = 'marker'; \n  el.style.backgroundImage = 'url(/assets/Marcador.png)';\n  el.style.backgroundSize = '100%';\n  el.style.width = 50 + 'px';\n  el.style.height = 70   + 'px';\n\n  const marker = new mapboxgl.Marker({\n    element: el,\n    draggable: false\n  })\n    .setLngLat([this.lng, this.lat])\n    .addTo(mapa)\n\n\n  this.sedes.forEach((sede) => {\n        const imagen = sede.creador.imagen.length > 0 ? 'https://motocaliapp.com/' + sede.creador.imagen[0].path : '/assets/Punto.png';\n        const miSede = document.createElement('div'); \n        miSede.className = 'marker'; \n        miSede.style.backgroundImage = 'url(' +  imagen + ')';\n        miSede.style.backgroundSize = '100%';\n        miSede.style.width = 50 + 'px';\n        miSede.style.height = 50   + 'px';\n      \n        const markerSede = new mapboxgl.Marker({\n          element: miSede,\n          draggable: false\n        })\n          .setLngLat([sede.ubicacion.lng, sede.ubicacion.lat])\n          .addTo(mapa)\n\n          miSede.addEventListener('click', () => {\n            console.log(sede);\n            this.miModal(sede, 1);\n          })\n      \n      })\n\n  this.loading.dismiss();\n}\n\n\n \nasync traerSedes() {\n  const info = await this.almacenamiento.obtenerToken();\n\n  if ( info ) {\n    this.apiMapas.buscarSedes(info.token, {ciudad: false, pais: false, filtros: false}).subscribe((data: any) => {\n      if ( data ){\n        console.log(data.response);\n        this.sedes = data.response;\n        this.graficar();\n      } else {\n        this.toastService.toastError('No se pudo traer las sedes, inténtelo más tarde');\n      }\n    }, (err) => {\n      this.toastService.toastError('No se pudo traer las sedes, inténtelo más tarde');\n    })\n  }\n}\n\n \n listarNegocios() {\n  this.apiUsuario.negocios().subscribe((data: any) => {\n    if (data.exe) {\n      data.response.forEach((item) => {\n        item.checked = false;\n      })\n      this.negocios = data.response;\n    } else {\n      this.negocios.push('Taller Mécanico');\n    }\n  }, (err) => {\n    this.negocios.push('Taller Mécanico');\n  })\n}\n\n\nlistarPaises() {\n  this.apiUsuario.listarPaises().subscribe((data: any) => {\n    if (data.exe) {\n      this.paises = data.response;\n    } else {\n      this.paises.push('Colombia');\n    }\n  }, (err) => {\n    this.paises.push('Colombia');\n  })\n}\n\n\nlistarCiudades( event, opt? ) {\n  console.log(event.detail)\n  this.pais = event.detail.value.nombre;\n  this.miciudad = '';\n  this.cargando = true;\n  this.apiUsuario.listarCiudades(event.detail.value._id).subscribe((data: any) => {\n   if (data.exe) {\n     this.ciudades = data.response;\n     this.ciudad = true;\n     if (opt) {\n       \n \n     }\n   } else {\n     this.toastService.toastError('No se pudo traer las ciudades, intente registrarse más tarde');\n   }\n   this.cargando = false;\n }, (err) => {\n   this.toastService.toastError('No se pudo traer las ciudades, intente registrarse más tarde');\n   this.cargando = false;\n })\n}\n\nseleccionarCiudad( event ) {\n this.miciudad = event.detail.value;\n}\n\nasync miModal(sede, vista) {\n  const modal = await this.modalCtrl.create({\n    component: ModalMapasPage,\n    componentProps: {\n      info: sede,\n      vista\n    }\n  })\n\n  await modal.present();\n}\n\nasync filtrar( evet ) {\n\n  const popov = await this.popover.create({\n    component: ModalMapasPage,\n    componentProps: {\n      vista : 2\n    },\n    event: evet\n  });\n\n  await popov.present();\n\n  const res = await popov.onWillDismiss();\n\n  if (res) {\n    if(res.data) {\n      const ciudad = res.data.ciudad ? res.data.ciudad : false;\n      const pais = res.data.pais ? res.data.pais : false;\n\n      console.log(res.data);\n      const info = await this.almacenamiento.obtenerToken();\n\n      if ( info ) {\n        const loading = await this.loading.create({\n          message: 'Cargando Mapa...',\n         spinner: 'circles'\n        })\n        await loading.present();\n        this.apiMapas.buscarSedes(info.token, {ciudad, pais, filtros: true, negocios: res.data.arreglo}).subscribe((data: any) => {\n          if ( data ){\n            console.log(data.response);\n            this.sedes = data.response;\n            this.graficar();\n          } else {\n            this.toastService.toastError('No se pudo traer las sedes, inténtelo más tarde');\n          }\n        }, (err) => {\n          this.toastService.toastError('No se pudo traer las sedes, inténtelo más tarde');\n        })\n      }\n    }\n  }\n\n}\n\n\n}\n","<ion-header class=\"ion-no-border\">\n    <ion-toolbar color=\"oscuro\">\n        <ion-back-button slot=\"start\" icon=\"chevron-back-outline\" defaultHref=\"/central/menu/inicioMapa\"></ion-back-button>\n        <ion-title>Ver Negocios</ion-title>\n\n        <ion-buttons slot=\"end\">\n            <ion-button (click)=\"filtrar( $event )\">\n                <ion-icon name=\"caret-down-outline\" slot=\"icon-only\"></ion-icon>\n            </ion-button>\n        </ion-buttons>\n\n    </ion-toolbar>\n</ion-header>\n\n<ion-content>\n\n    <div class=\"mapa\" #mapa></div>\n\n</ion-content>"]}