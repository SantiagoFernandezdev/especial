{"version":3,"sources":["webpack:///src/app/pages/Mapas/grua/grua-routing.module.ts","webpack:///src/app/pages/Mapas/grua/grua.module.ts","webpack:///src/app/pages/Mapas/grua/grua.page.ts","webpack:///src/app/pages/Mapas/grua/grua.page.html"],"names":["routes","path","component","GruaPageRoutingModule","forChild","imports","exports","GruaPageModule","entryComponents","declarations","GruaPage","alertCtrl","geoReferencia","usuaripService","almacenamiento","statusbar","router","toast","loading","modalCtrl","lat","lng","mensaje","imagen","backgroundColorByHexString","llamarFoto","confirmarUbicacion","create","header","message","backdropDismiss","buttons","role","text","handler","toastNotificacion","navigate","calcular","alert","present","console","log","getCurrentPosition","data","coords","latitude","longitude","graficar","obtenerToken","info","viewImagen","token","subscribe","url","paquete","error","mapboxgl","accessToken","mapa","Map","container","nativeElement","style","center","zoom","addControl","NavigationControl","el","document","createElement","className","backgroundImage","backgroundSize","width","height","marker","Marker","element","draggable","setLngLat","addTo","el2","on","lngLat","getLngLat","marker2","componentProps","modal","selector","templateUrl","styleUrls"],"mappings":"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","file":"Mapas-grua-grua-module-es5.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { GruaPage } from './grua.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: GruaPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class GruaPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { GruaPageRoutingModule } from './grua-routing.module';\n\nimport { GruaPage } from './grua.page';\nimport { ModalMapasPage } from '../modal-mapas/modal-mapas.page';\nimport { ModalMapasPageModule } from '../modal-mapas/modal-mapas.module';\n\n@NgModule({\n  entryComponents: [\n    ModalMapasPage\n  ],\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    GruaPageRoutingModule,\n    ModalMapasPageModule\n  ],\n  declarations: [GruaPage]\n})\nexport class GruaPageModule {}\n","import { Component, OnInit, ViewChild, ElementRef } from '@angular/core';\nimport { Geolocation } from '@ionic-native/geolocation/ngx';\nimport { AlertController, ModalController } from '@ionic/angular';\nimport { UsuariosLoginService } from '../../../providers/Api/UsuariosLogin.service';\nimport { InicioService } from '../../../providers/Almacenamiento/inicio.service';\nimport { StatusBar } from '@ionic-native/status-bar/ngx';\nimport { Router } from '@angular/router';\nimport { ToastServices } from '../../../providers/Utilidades/ToastService.service';\nimport { LoadingService } from '../../../providers/Utilidades/LoadingService.service';\nimport { ModalMapasPage } from '../modal-mapas/modal-mapas.page';\n\ndeclare var mapboxgl;\n\n@Component({\n  selector: 'app-grua',\n  templateUrl: './grua.page.html',\n  styleUrls: ['./grua.page.scss'],\n})\nexport class GruaPage implements OnInit {\n\n  lat = 0;\n  lng = 0;\n\n  mensaje = '';\n\n  imagen = '';\n\n  @ViewChild('mapa') mapa: ElementRef;\n\n  constructor(\n    private alertCtrl: AlertController,\n    private geoReferencia: Geolocation,\n    private usuaripService: UsuariosLoginService,\n    private almacenamiento: InicioService,\n    private statusbar: StatusBar,\n    private router: Router,\n    private toast: ToastServices,\n    private loading: LoadingService,\n    private modalCtrl: ModalController\n  ) { }\n\n  ngOnInit() {\n\n \n  }\n\n  ionViewWillEnter() {\n    this.statusbar.backgroundColorByHexString('#273238');\n    this.llamarFoto();\n    this.confirmarUbicacion();\n  }\n\n  async confirmarUbicacion() {\n    const alert = await this.alertCtrl.create({\n      header: 'Mensaje de la App',\n      message: 'Permitir compartir la ubciación para realizar esta acción',\n      backdropDismiss: false,\n      buttons: [\n        {\n          role: 'cancel',\n          text: 'Cancelar',\n          handler: () => {\n            this.toast.toastNotificacion('No se puede realizar la acción debido a no compartir la ubicación', 3000)\n            this.router.navigate(['/central/menu/inicioMapa']);\n          }\n        },\n        {\n          text: 'Permitir',\n          handler: () => {\n            this.calcular();\n          }\n        }\n      ]\n    })\n\n    await alert.present();\n  }\n\n  async calcular() {\n    try {\n      console.log('entramos al click')\n      const data = await this.geoReferencia.getCurrentPosition();\n\n      if ( data ) {\n      console.log(data);\n      this.lat = data.coords.latitude;\n      this.lng = data.coords.longitude;\n      this.graficar();\n    }\n    } catch (error) {\n      \n      this.mensaje = error;\n    }\n  }\n\n  \nasync llamarFoto() {\n\n  const info = await this.almacenamiento.obtenerToken();\n\n  if ( info ) {\n    this.usuaripService.viewImagen(info.token).subscribe((url: any) => {\n      // // console.log(url);\n      this.imagen = `https://motocaliapp.com/${url.paquete}`;\n      console.log(this.imagen)\n    }, (error) => {\n      // // console.log(error);\n    })\n  }\n      \n    }\n\n  graficar() {\n    mapboxgl.accessToken = 'pk.eyJ1Ijoic2FudGlhZ29mZXJuYW5kZXpkZXYiLCJhIjoiY2tmYmh6cXdzMDM0bDJ2cHRucTI4cHpkaSJ9.-01EYvsLdJOU1Oy4BtwBwA';\n    const mapa = new mapboxgl.Map({\n    container: this.mapa.nativeElement,\n    style: 'mapbox://styles/mapbox/streets-v11',\n    center: [this.lng, this.lat],\n    zoom: 15\n    });\n\n    mapa.addControl(new mapboxgl.NavigationControl());\n\n    const el = document.createElement('div'); \n    el.className = 'marker'; \n    el.style.backgroundImage = 'url(' + this.imagen + ')';\n    el.style.backgroundSize = '100%';\n    el.style.width = 50 + 'px';\n    el.style.height = 50   + 'px';\n\n    const marker = new mapboxgl.Marker({\n      element: el,\n      draggable: true\n    })\n      .setLngLat([this.lng, this.lat])\n      .addTo(mapa)\n\n      const el2 = document.createElement('div'); \n    el2.className = 'marker'; \n    el2.style.backgroundImage = 'url(' + this.imagen + ')';\n    el2.style.backgroundSize = '100%';\n    el2.style.width = 50 + 'px';\n    el2.style.height = 50   + 'px';\n\n    marker.on('dragend', () => {\n          const lngLat = marker.getLngLat();\n          console.log('Longitude: ' + lngLat.lng + '<br />Latitude: ' + lngLat.lat)\n        });\n\n\n    const marker2 = new mapboxgl.Marker({\n          element: el2,\n          draggable: true\n        })\n          .setLngLat([-76.49279796685475, 3.4727944759127922])\n          .addTo(mapa)\n    \n        marker2.on('dragend', () => {\n              const lngLat = marker2.getLngLat();\n              console.log('Longitude: ' + lngLat.lng + '<br />Latitude: ' + lngLat.lat)\n            });\n    \n  }\n\n  async modal() {\n\n    const modal = await this.modalCtrl.create({\n      component: ModalMapasPage,\n      componentProps: {\n        \n      }\n    });\n\n    await modal.present();\n\n  }\n\n  ionViewWillLeave(){\n    this.statusbar.backgroundColorByHexString('#777777');\n  }\n\n}\n","<ion-header>\n    <ion-toolbar color=\"oscuro\">\n        <ion-back-button slot=\"start\" icon=\"chevron-back-outline\" defaultHref=\"/central/menu/inicioMapa\"></ion-back-button>\n        <ion-title>Sistema de Grúa</ion-title>\n        <ion-buttons slot=\"end\">\n            <ion-button (click)=\"modal()\">\n                <ion-icon name=\"add-outline\" slot=\"icon-only\"></ion-icon>\n            </ion-button>\n        </ion-buttons>\n    </ion-toolbar>\n</ion-header>\n\n<ion-content>\n\n    <div class=\"mapa\" #mapa>\n\n    </div>\n\n\n</ion-content>"]}