{"version":3,"sources":["webpack:///src/app/Pages/EstadoCitas/chat/chat-routing.module.ts","webpack:///src/app/Pages/EstadoCitas/chat/chat.module.ts","webpack:///src/app/Pages/EstadoCitas/chat/chat.page.html","webpack:///src/app/Pages/EstadoCitas/chat/chat.page.ts","webpack:///src/app/Pages/EstadoCitas/chat/video.directive.ts","webpack:///src/app/Pages/Modales/modal-citas/modal-citas-routing.module.ts","webpack:///src/app/Pages/Modales/modal-citas/modal-citas.module.ts","webpack:///src/app/Pages/Modales/modal-citas/modal-citas.page.html","webpack:///src/app/Pages/Modales/modal-citas/modal-citas.page.ts"],"names":["routes","path","component","ChatPageRoutingModule","forChild","imports","exports","ChatPageModule","entryComponents","declarations","ChatPage","activeRoute","apiEstadoCitas","sockect","almacenamiento","cargarElementos","modalCtrl","geo","camera","actionSheet","myLoading","media","toast","conexiones","menu","animationCtrl","color","idCita","data","imagen","taller","conversacionTemporal","conversacion","mensaje","usuario","local","nombre","red","tallerId","usuarioID","idActual","dataInfoCita","escribiendo","carrete","carreteArriba","directorios","urlInfo","url","tipo","paginacion","cargar","conexion","cargoprimero","video","$cargarRed","subscribe","obtenerToken","then","info","emit","volver","recibirMensaje","push","id","_id","emisor","fechaMensaje","archivos","audio","Audio","play","escribirOnCita","exe","$conexiones","estado","actualizarVideo","map","item","file","nameBD","nameSecret","console","log","enable","arrancar","obtenerCita","cita","token","response","length","nusuario","idtaller","nombreusuario","usuariopedido","nombrecompleto","usuariohost","fechaInicio","fechainicio","fechaprogreso","fechacumplido","role","precio","trabajos","listaTrabajos","obtenerConversacionesPendientes","mensajes","forEach","obtenerConversaciones","toString","unshift","setTimeout","scrollbajar","event","target","complete","infinito","disabled","catch","alertApplication","contenido","scrollToBottom","myobserver","observer","on","next","cargaProcesos","ingresarChat","sort","a","b","mime","cont","subirArchivosChat","name","image","JSON","parse","idEmit","includes","finalizarCargado","error","format","type","modal","enterAnimation","baseEl","backdropAnimation","create","addElement","querySelector","fromTo","wrapperAnimation","keyframes","offset","opacity","transform","easing","duration","addAnimation","leaveAnimation","direction","componentProps","mode","present","onWillDismiss","modalInfo","editarCita","miCita","getCurrentPosition","ok","subHeader","header","buttons","text","icon","handler","tomarFoto","PictureSourceType","CAMERA","capturarVideo","PHOTOLIBRARY","miHojaAccion","sourceType","options","quality","allowEdit","correctOrientation","destinationType","DestinationType","FILE_URI","mediaType","MediaType","PICTURE","VIDEO","getPicture","imageData","mim","window","Ionic","WebView","convertFileSrc","cleanup","opctions","limit","captureVideo","fullPath","indice","splice","find","getScrollElement","e","eleminarCita","r","loadData","escribirMensaje","cambiar","camaraOpciones","enviarMensaje","optional","selector","templateUrl","styleUrls","animations","static","VideoDirective","el","nativeElement","currentTime","ModalCitasPageRoutingModule","ModalCitasPageModule","ModalCitasPage","actionSheetCtrl","citasService","utitlities","titulo","listaTalleres","estadoCambio","urlArchivo","tipoArchivo","slideOpt","zoom","maxRatio","minRatio","toggle","citas","texto","listaCreados","nuevoTrabajo","textoTrabajo","textoBuscar","precioconfig","msgEstado","msgpro","msgter","terminado","ui","obtenerListaTrabajos","res","vista","slide","lockSwipes","listarTalleres","filtrado","filter","unico","detail","value","dismiss","salir","listadoTalleres","avatar","usuarioReceptor","translucent","cssClass","slideNext","crearCita","slidePrev","trabajo","i"],"mappings":"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","file":"Pages-EstadoCitas-chat-chat-module-es5.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { ChatPage } from './chat.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: ChatPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class ChatPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { ChatPageRoutingModule } from './chat-routing.module';\n\nimport { ChatPage } from './chat.page';\nimport { ModalCitasPage } from '../../Modales/modal-citas/modal-citas.page';\nimport { ModalCitasPageModule } from '../../Modales/modal-citas/modal-citas.module';\nimport { PipesModule } from '../../../pipes/pipes.module';\nimport { ComponentsModule } from '../../../Components/components.module';\nimport { VideoDirective } from './video.directive';\n\n@NgModule({\n  entryComponents: [\n    ModalCitasPage\n  ],\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    ChatPageRoutingModule,\n    ModalCitasPageModule,\n    PipesModule,\n    ComponentsModule\n  ],\n  declarations: [\n    ChatPage,\n    VideoDirective\n  ]\n})\nexport class ChatPageModule {}\n","<ion-header class=\"ion-no-border\">\n    <ion-toolbar color=\"blanco\">\n\n\n        <div class=\"title\">\n            <div class=\"taller\">\n                <ion-buttons>\n                    <ion-back-button defaultHref=\"/central/menu/miscitas\" icon=\"chevron-back-outline\">\n                    </ion-back-button>\n\n                </ion-buttons>\n                <ion-avatar *ngIf=\"imagen !== ''\">\n                    <img [src]=\"imagen\">\n                </ion-avatar>\n                <div class=\"info\" *ngIf=\"nombre !== ''\">\n                    <h4>{{ nombre }}</h4>\n                    <h5 class=\"conx\" *ngIf=\"(escribiendo === false && conexion === 'conexion')\"> <span class=\"bola verde\"></span> Conectado</h5>\n                    <h5 class=\"conx\" *ngIf=\"(escribiendo === false && conexion === 'desconexion')\"> <span class=\"bola rojo\"></span> Desconectado</h5>\n                    <h5 class=\"small\" *ngIf=\"escribiendo\"> Escribiendo...</h5>\n                </div>\n            </div>\n\n        </div>\n    </ion-toolbar>\n</ion-header>\n\n<ion-content #contenido>\n    <ion-infinite-scroll #infinito position=\"top\" threshold=\"100px\" (ionInfinite)=\"loadData($event)\">\n        <ion-infinite-scroll-content loadingSpinner=\"bubbles\" loadingText=\"Cargando mensajes...\">\n        </ion-infinite-scroll-content>\n    </ion-infinite-scroll>\n    <ion-grid>\n        <ion-row *ngFor=\"let conver of conversacion\">\n            <ion-col size=\"9\" class=\"final\" push=\"3\" *ngIf=\"local === conver.emisor\">\n                <div class=\"grispo col \">\n                    <div class=\"images\" *ngIf=\"conver.archivos.length > 0\">\n                        <div class=\"imageChild\" *ngFor=\"let file of conver.archivos\">\n                            <img *ngIf=\"file.type.includes('image')\" src=\"https://motocaliapp.com/Citas/{{ file.nameBD }}\" (click)=\"seleccionarMedia(file.nameBD, 'imagen')\" alt=\" \">\n\n                            <div *ngIf=\"file.nameBD === 'none'\">\n                                <ion-spinner name=\"crescent\"></ion-spinner> El vídeo estará disponible en un momento\n                            </div>\n\n                            <div *ngIf=\"file.nameBD !== 'none'\">\n                                <div class=\"btn\" *ngIf=\"!file.type.includes('image') \" (click)=\"seleccionarMedia(file.nameBD, 'video') \" color=\"success\">\n                                    <video video-load poster=\"/assets/icon/favicon.png\" src=\"https://motocaliapp.com/Citas/{{file.nameBD}}\"></video>\n\n\n                                    <ion-button class=\"btn-f\" color=\"oscuro\" mode=\"ios\">\n                                        <ion-icon name=\"play-outline\" slot=\"icon-only\"></ion-icon>\n                                    </ion-button>\n                                </div>\n                            </div>\n\n\n\n                            <!-- <div class=\"btn\" *ngIf=\"!file.name.includes( 'image') \" (click)=\"seleccionarMedia(file.nameBD, 'video') \" color=\"success\">\n                            <h4 class=\"btn-h\">Abrir Vídeo</h4>\n                            <ion-button color=\"success\" mode=\"ios\">\n                                <ion-icon name=\"play-outline\" slot=\"icon-only\"></ion-icon>\n                            </ion-button>\n                            <h4 class=\"btn-f\">MimotoApp </h4>\n                        </div> -->\n\n\n                            <!-- <video *ngIf=\"!file.name.includes( 'image') \" width=\"100% \" src=\"https://motocaliapp.com/Citas/ \" controls></video>-->\n                        </div>\n                    </div>\n                    <div class=\"msg \">\n                        {{ conver.mensaje }}\n                    </div>\n                    <div class=\"fh \">\n                        <div class=\"fecha\">{{ conver.fechaMensaje }}</div>\n\n                    </div>\n                </div>\n            </ion-col>\n            <ion-col size=\"11\" class=\" visi\" *ngIf=\"local !== conver.emisor \">\n                <div class=\"imagen\">\n                    <ion-avatar *ngIf=\"imagen !== ''\">\n                        <img [src]=\"imagen\">\n                    </ion-avatar>\n                </div>\n                <div class=\"grispi col\">\n                    <div class=\"images\" *ngIf=\"conver.archivos.length> 0\">\n                        <div class=\"imageChild\" *ngFor=\"let file of conver.archivos\">\n                            <img *ngIf=\"file.type.includes('image')\" src=\"https://motocaliapp.com/Citas/{{ file.nameBD }}\" (click)=\"seleccionarMedia(file.nameBD, 'imagen')\" alt=\" \">\n                            <div *ngIf=\"file.nameBD === 'none'\">\n                                <ion-spinner name=\"crescent\"></ion-spinner> El vídeo estará disponible en un momento\n                            </div>\n\n                            <div *ngIf=\"file.nameBD !== 'none'\">\n                                <div class=\"btn\" *ngIf=\"!file.type.includes('image') \" (click)=\"seleccionarMedia(file.nameBD, 'video') \" color=\"success\">\n                                    <video video-load poster=\"/assets/icon/favicon.png\" src=\"https://motocaliapp.com/Citas/{{file.nameBD}}\"></video>\n\n\n                                    <ion-button class=\"btn-f\" color=\"oscuro\" mode=\"ios\">\n                                        <ion-icon name=\"play-outline\" slot=\"icon-only\"></ion-icon>\n                                    </ion-button>\n                                </div>\n                            </div>\n\n                            <!-- <div class=\"btn\" *ngIf=\"!file.name.includes( 'image') \" (click)=\"seleccionarMedia(file.nameBD, 'video') \" color=\"success\">\n                                <h4 class=\"btn-h\">Abrir Vídeo</h4>\n                                <ion-button color=\"success\" mode=\"ios\">\n                                    <ion-icon name=\"play-outline\" slot=\"icon-only\"></ion-icon>\n                                </ion-button>\n                                <h4 class=\"btn-f\">MimotoApp </h4>\n                            </div> -->\n\n\n                        </div>\n                    </div>\n                    <div class=\"msg \">\n                        {{ conver.mensaje }}\n                    </div>\n                    <div class=\"fh \">\n                        <div class=\"fecha\">{{ conver.fechaMensaje }}</div>\n\n                    </div>\n                </div>\n\n            </ion-col>\n        </ion-row><br>\n    </ion-grid>\n\n    <div class=\"fotos \" @entrada *ngIf=\"carrete.length> 0\">\n        <div class=\"titulo\">Fotos para subir</div>\n        <div class=\"carrete\">\n            <div class=\"fotoHija\" *ngFor=\"let image of carrete; let i = index\">\n                <img *ngIf=\"image.includes('jpg')\" src=\"{{image}}\" width=\"70px\">\n                <video *ngIf=\"image.includes('mp4')\" src=\"{{image}}\" width=\"70px\" controls></video>\n                <div class=\"eliminar\" (click)=\"eliminardelCarrete(i)\">\n                    <ion-chip color=\"danger\">Eliminar</ion-chip>\n                </div>\n            </div>\n        </div>\n\n    </div>\n\n</ion-content>\n\n<ion-footer class=\"flexible ion-no-border\">\n    <div class=\"text\">\n        <ion-textarea class=\"campo\" [(ngModel)]=\"mensaje\" placeholder=\"Escribe un mensaje\" (ionInput)=\"escribirMensaje()\" (ionBlur)=\"cambiar()\"></ion-textarea>\n        <div class=\"opt\">\n            <ion-button color=\"blanco\" fill=\"clear\" (click)=\"camaraOpciones()\">\n                <ion-icon slot=\"icon-only\" name=\"camera-outline\" color=\"medium\"></ion-icon>\n            </ion-button>\n        </div>\n    </div>\n    <div class=\"botones\">\n        <ion-button (click)=\"enviarMensaje()\" fill=\"clear\">\n            <ion-icon slot=\"icon-only\" name=\"send-outline\" color=\"success\"></ion-icon>\n        </ion-button>\n    </div>\n</ion-footer>","import { Component, OnInit, ViewChild, ElementRef } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\nimport { EstadoCitasService } from '../../../providers/Api/EstadoCitas.service';\nimport { Socket } from 'ngx-socket-io';\nimport { Observable } from 'rxjs';\nimport { InicioService } from 'src/app/providers/Almacenamiento/inicio.service';\nimport { CargaElementosUsuariosService } from '../../../providers/cargas/usuarios.service';\nimport { trigger, transition, query, stagger, animate, style } from '@angular/animations';\nimport { IonContent, ModalController, ActionSheetController, IonInfiniteScroll, MenuController, AnimationController } from '@ionic/angular';\nimport { ModalCitasPage } from '../../Modales/modal-citas/modal-citas.page';\nimport { Geolocation } from '@ionic-native/geolocation/ngx';\nimport { Camera, CameraOptions } from '@ionic-native/camera/ngx';\nimport * as moment from 'moment';\nimport { LoadingService } from '../../../providers/Utilidades/LoadingService.service';\nimport { MediaCapture, MediaFile, CaptureError, CaptureImageOptions, CaptureVideoOptions } from '@ionic-native/media-capture/ngx';\nimport { ToastServices } from '../../../providers/Utilidades/ToastService.service';\nimport { ConexionService } from '../../../providers/Conexiones/Conexion.service';\n\n\ndeclare var window: any;\n\n@Component({\n  selector: 'app-chat',\n  templateUrl: './chat.page.html',\n  styleUrls: ['./chat.page.scss'],\n  animations: [\n      trigger('mensajes', [\n        transition('* => *', [\n          query(':enter', [\n            style({\n              transform: 'scale(0)',\n              opacity: 0\n            }),\n            stagger(100, [\n              animate('100ms', style({\n                transform: 'scale(1)',\n                opacity: 1\n              }))\n            ])\n          ], {optional: true})\n        ])\n      ]),\n      trigger('entrada', [\n        transition(':enter', [\n          style({\n            transform: 'scale(0)',\n            opacity: 0\n          }),\n          animate('300ms', style({\n            transform: 'scale(1)',\n            opacity: 1\n          }))\n        ])\n      ])\n  ]\n})\nexport class ChatPage implements OnInit {\n\n  color: any = '';\n  idCita: any = '';\n\n  data = [];\n  imagen: any = '';\n  taller: any = '';\n  conversacionTemporal: any[] = [];\n  conversacion: any[] = [];\n  mensaje = '';\n  usuario = '';\n  local = '';\n  nombre: any = '';\n  red = 'wifi';\n\n  tallerId = '';\n  usuarioID = '';\n  idActual = '';\n\n  dataInfoCita: any = {};\n  escribiendo = false;\n\n  carrete = [];\n  carreteArriba = [];\n\n  // Archivos\n\n  directorios: any[] = [];\n  urlInfo = {\n    url: '',\n    tipo: 'video'\n  };\n\n  // Mensajes Optimizacion\n\n  paginacion = 0;\n  cargar = false;\n  conexion = '';\n  cargoprimero = false;\n\n  video = false;\n\n  @ViewChild('contenido', {static: false}) contenido: IonContent;\n  @ViewChild('infinito', {static: false}) infinito: IonInfiniteScroll;\n\n  constructor(\n    private activeRoute: ActivatedRoute,\n    private apiEstadoCitas: EstadoCitasService,\n    private sockect: Socket,\n    private almacenamiento: InicioService,\n    private cargarElementos: CargaElementosUsuariosService,\n    private modalCtrl: ModalController,\n    private geo: Geolocation,\n    private camera: Camera,\n    private actionSheet: ActionSheetController,\n    private myLoading: LoadingService,\n    private media: MediaCapture,\n    private toast: ToastServices,\n    private conexiones: ConexionService,\n    private menu: MenuController,\n    private animationCtrl: AnimationController\n  ) {\n\n    this.cargarElementos.$cargarRed.subscribe(async (red: any) => {\n      this.red = red;\n      if (this.red !== 'none') {\n            // console.log('Me ejecuto siii')\n            this.almacenamiento.obtenerToken().then((info) => {\n\n              this.sockect.emit('conectar', info);\n              this.volver(info);\n\n            })\n      }\n    });\n\n    this.recibirMensaje().subscribe(async (data: any) => {\n      // console.log('2');\n      // tslint:disable-next-line:max-line-length\n      this.conversacion.push({id: data._id, taller: this.taller, usuario: this.usuario, emisor: data.emisor, mensaje: data.mensaje, fechaMensaje: data.fechaMensaje, archivos: data.archivos});\n      // // console.log('se jecuta el suscribe');\n      const audio = new Audio('/assets/Notificacion.mp3');\n      audio.play();\n    });\n\n\n    this.escribirOnCita().subscribe(async (data: any) => {\n      // console.log('3');\n      this.escribiendo = data.exe;\n\n    });\n\n\n    this.conexiones.$conexiones.subscribe((data: any) => {\n      // console.log('Data de la conexión ', data, this.idActual)\n      if (data.usuario === this.idActual) {\n          this.conexion = data.estado;\n      }\n    })\n\n    this.actualizarVideo().subscribe((data: any) => {\n      // console.log('Data de la conexión ', data, this.idActual)\n      this.conversacion = this.conversacion.map((item: any) => {\n        if (item.id) {\n          if (item.id === data._id) {\n            item.archivos = item.archivos.map((file) => {\n              if (file.nameBD === 'none') {\n                file.nameBD = data.nameSecret;\n              }\n              return file;\n            });\n          }\n        }\n        return item;\n      })\n      console.log(this.conversacion, 'Ultimo');\n    })\n\n  }\n\n  ngOnInit() {\n  }\n\n  ionViewWillEnter() {\n    this.menu.enable(false, 'perfilMenu');\n    this.arrancar();\n\n  }\n\n  async volver(info) {\n    const cita =  await this.almacenamiento.obtenerCita();\n    if (cita) {\n\n      // console.log(info, 'Todo bien por aca');\n        \n      this.idCita = cita;\n        \n      this.apiEstadoCitas.obtenerCita(info.token, this.idCita).subscribe( async (data: any) => {\n\n                // console.log(data, ' data');\n                this.data = data.response;\n                if (data.response.length > 0) {\n                  \n          \n                  if (info.nusuario === data.response[0].idtaller.nombreusuario) {\n                    this.imagen = `https://motocaliapp.com/${data.response[0].usuariopedido.imagen[0].path}`;\n                    this.nombre = data.response[0].usuariopedido.nombrecompleto;\n                    this.sockect.emit('entrarChatCita', {\n                      _id: this.idCita,\n                      usuario: data.response[0].usuariopedido._id,\n                      usuariohost: data.response[0].idtaller._id\n                    });\n                    this.idActual = data.response[0].usuariopedido._id;\n          \n                  } else if (info.nusuario === data.response[0].usuariopedido.nombreusuario) {\n                    this.imagen = `https://motocaliapp.com/${data.response[0].idtaller.imagen[0].path}`;\n                    this.nombre = data.response[0].idtaller.nombrecompleto;\n    \n                    this.sockect.emit('entrarChatCita', {\n                      _id: this.idCita,\n                      usuario: data.response[0].idtaller._id,\n                      usuariohost: data.response[0].usuariopedido._id\n                    });\n                    this.idActual = data.response[0].idtaller._id;\n                  }\n                 // this.estado(data.response[0].estado);\n                  this.taller = data.response[0].idtaller.nombreusuario;\n          \n                  this.usuario = data.response[0].usuariopedido.nombreusuario;\n                  this.tallerId = data.response[0].idtaller._id;\n          \n                  this.usuarioID = data.response[0].usuariopedido._id;\n          \n                  this.dataInfoCita.fechaInicio = data.response[0].fechainicio;\n                  this.dataInfoCita.fechaprogreso = data.response[0].fechaprogreso;\n                  this.dataInfoCita.fechacumplido = data.response[0].fechacumplido;\n                  this.dataInfoCita.role = info.role;\n                  this.dataInfoCita.precio = data.response[0].precio;\n                  this.dataInfoCita.trabajos = data.response[0].listaTrabajos;\n          \n                  // console.log(this.conversacion.length, ' conversaciones');\n                  if (this.conversacion.length > 0) {\n                    // tslint:disable-next-line:max-line-length\n                    this.apiEstadoCitas.obtenerConversacionesPendientes(info.token, this.idCita, this.conversacion[this.conversacion.length - 1].fechaMensaje).subscribe(async (mensajes: any) => {\n    \n                      if (mensajes.exe) {\n                         mensajes.response.forEach((item) => {\n                          this.conversacion.push(item);\n                        })\n                      }\n                      // console.log(mensajes, this.conversacion, 'Recargar nuevos msg');\n            \n                    });\n                  }\n          \n                }\n            });\n            }\n  }\n\n  async arrancar() {\n    const cita =  await this.almacenamiento.obtenerCita();\n    if (cita) {\n      this.cargoprimero = true;\n\n      this.idCita = cita;\n      // console.log(cita, ' ionviewWillEnter');\n\n      this.almacenamiento.obtenerToken().then((info: any) => {\n \n      this.local = info.nusuario;\n      this.apiEstadoCitas.obtenerCita(info.token, this.idCita).subscribe( async (data: any) => {\n      this.data = data.response;\n      if (data.response.length > 0) {\n     \n        if (info.nusuario === data.response[0].idtaller.nombreusuario) {\n          this.imagen = `https://motocaliapp.com/${data.response[0].usuariopedido.imagen[0].path}`;\n          this.nombre = data.response[0].usuariopedido.nombrecompleto;\n          this.idActual = data.response[0].usuariopedido._id;\n\n          this.sockect.emit('entrarChatCita', {\n            _id: this.idCita,\n            usuario: data.response[0].usuariopedido._id,\n            usuariohost: data.response[0].idtaller._id\n          });\n\n        } else if (info.nusuario === data.response[0].usuariopedido.nombreusuario) {\n          this.imagen = `https://motocaliapp.com/${data.response[0].idtaller.imagen[0].path}`;\n          this.nombre = data.response[0].idtaller.nombrecompleto;\n          this.idActual = data.response[0].idtaller._id;\n          this.sockect.emit('entrarChatCita', {\n            _id: this.idCita,\n            usuario: data.response[0].idtaller._id,\n            usuariohost: data.response[0].usuariopedido._id\n          });\n        }\n       // this.estado(data.response[0].estado);\n        this.taller = data.response[0].idtaller.nombreusuario;\n\n        this.usuario = data.response[0].usuariopedido.nombreusuario;\n        this.tallerId = data.response[0].idtaller._id;\n\n        this.usuarioID = data.response[0].usuariopedido._id;\n\n        // Información de la cita\n\n        this.dataInfoCita.estado = data.response[0].estado;\n        this.dataInfoCita.fechaInicio = data.response[0].fechainicio;\n        this.dataInfoCita.fechaprogreso = data.response[0].fechaprogreso;\n        this.dataInfoCita.fechacumplido = data.response[0].fechacumplido;\n        this.dataInfoCita.role = info.role;\n        this.dataInfoCita.precio = data.response[0].precio;\n        this.dataInfoCita.trabajos = data.response[0].listaTrabajos;\n\n        this.apiEstadoCitas.obtenerConversaciones(info.token, this.idCita, this.paginacion.toString()).subscribe(async (mensajes: any) => {\n\n          if (mensajes.exe) {\n             mensajes.response.forEach((item) => {\n              this.conversacion.unshift(item);\n            })\n\n            setTimeout(() => {\n              this.scrollbajar();\n            }, 1000)\n          }\n          // console.log(mensajes, 'Me guta');\n\n        });\n\n        // Scrolling\n\n\n      }\n    });\n  });\n  }\n  }\n\n  loadData( event ) {\n    if ( this.cargar ) {\n      this.paginacion = this.paginacion + 10;\n      // console.log(event, 'Cargando data', this.paginacion);\n      this.almacenamiento.obtenerToken().then((info: any) => {\n        this.apiEstadoCitas.obtenerConversaciones(info.token, this.idCita, this.paginacion.toString()).subscribe(async (mensajes: any) => {\n\n          if (mensajes.exe) {\n              mensajes.response.forEach((item) => {\n                this.conversacion.unshift(item);\n              })\n          \n          }\n          // console.log(mensajes, 'Me guta');\n          event.target.complete();\n          if (mensajes.response.length === 0) {\n            this.infinito.disabled = true;\n          }\n          \n  \n        });\n      }).catch(() => {\n        this.toast.alertApplication('No se pudo traer mas mensajes', false)\n        event.target.complete();\n      });\n     \n    }\n  }\n\n  // valid( file ) {\n  //   return this.file.checkFile(this.file.dataDirectory + 'MimotoMedia/', file).then(() => {\n  //     return true;\n  //   }).catch(() => {\n  //     return false;\n  //   })\n  // }\n\n  // descargar( file ) {\n  //   // console.log('Bine');\n  //   this.myLoading.cargaProcesos('Descargando');\n  //   this.apiEstadoCitas.descargarArchivosChat(file).subscribe((descarga) => {\n  //     // console.log(descarga, ' Descargando');\n  //     this.myLoading.finalizarCargado();\n  //     this.file.listDir(this.file.dataDirectory, 'MimotoMedia').then((des) => {\n  //       // console.log(des);\n  //     }).catch((error) => {\n        \n  //       // console.log(error, ' Error al descargar')\n  //     })\n     \n  //   }, (err) => {\n  //     this.myLoading.finalizarCargado();\n  //     // console.log('Error al descargar', err)\n  //   });\n  // }\n\n\n  scrollbajar() {\n     this.contenido.scrollToBottom(0).then(() => {\n       // console.log('Vientos');\n       this.cargar = true;\n     });\n  }\n\n\n  // estado(status) {\n  //   switch (status) {\n  //     case 'PENDIENTE':\n  //       this.color = 'warning';\n  //       break;\n\n  //     case 'EN PROGRESO':\n  //       this.color = 'secondary';\n  //       break;\n\n  //     case 'TERMINADO':\n  //       this.color = 'success';\n  //       break;\n  //   }\n\n  //   this.dataInfoCita.estado = status;\n  // }\n\n  actualizarVideo() {\n    const myobserver = new Observable(observer => {\n      this.sockect.on('subirVideo', (data) => {\n        observer.next(data);\n        console.log(data, 'actualizado')\n      });\n    });\n\n    return myobserver;\n  }\n\n\n  async enviarMensaje() {\n    // console.log(this.carreteArriba);\n    if ( this.carreteArriba.length > 0 ) {\n        const info = await this.almacenamiento.obtenerToken();\n        this.myLoading.cargaProcesos('Subiendo mensaje con archivos media, por favor espere');\n        if ( info ) {\n          // console.log(info);\n          this.apiEstadoCitas.ingresarChat(info.token, {\n            _id: this.idCita,\n            mensaje: this.mensaje,\n            emisor: this.local,\n            taller: this.tallerId,\n            usuario: this.usuarioID\n          }).subscribe((data: any) => {\n              // console.log(data);\n              if (data.exe) {\n                const id = data.response._id;\n                this.carreteArriba = this.carreteArriba.sort((a, b) => {\n                  if (a.mime > b.mime) {\n                    return 1;\n                  }\n                  if (a.mime < b.mime) {\n                    return -1;\n                  }\n                  // a must be equal to b\n                  return 0;\n                });\n                console.log(this.carreteArriba, ' imagenes');\n                let cont = this.carreteArriba.length;\n                this.carreteArriba.forEach((item) => {\n                  // console.log(item, 'itm');\n                  this.apiEstadoCitas.subirArchivosChat(info.token, id, item.path, item.name, item.mime).subscribe((image: any) => {\n                        image.response = JSON.parse(image.response);\n                        if (image.response.exe) {\n                          cont--;\n\n                          if (cont === 0) {\n                            image.response.response.tipo = 'file';\n                            image.response.response.idEmit = this.idActual;\n\n                            if ( item.mime.includes('video')) {\n                              this.sockect.emit('subirarchivo', image.response.response);\n                            }\n                            \n                            this.sockect.emit('mensajeCita', image.response.response);\n                            image.response.response.id = image.response.response._id;\n                            this.conversacion.push(image.response.response);\n                            this.carrete = [];\n                            this.carreteArriba = [];\n                            this.mensaje = '';\n                            this.myLoading.finalizarCargado();\n                          }\n\n                        }\n                        // console.log(image, ' image cada vuelta');\n                  }, (error) => {\n                    // console.log('Error ', error);\n                    this.myLoading.finalizarCargado();\n                    this.toast.alertApplication('No se pudo subir el archivo de vídeo o imagen', true);\n                  });\n                });\n              }\n          });\n        }\n    } else {\n      if (this.mensaje !== '') {\n        this.conversacion.push({taller: this.taller, usuario: this.usuario, emisor: this.local, mensaje: this.mensaje, archivos: [], fechaMensaje: moment().format('YYYY-MM-DD HH:mm')});\n        this.sockect.emit('mensajeCita', {\n          _id: this.idCita,\n          mensaje: this.mensaje,\n          emisor: this.local,\n          taller: this.tallerId,\n          usuario: this.usuarioID,\n          tipo: 'msg',\n          idEmit: this.idActual\n        });\n        this.mensaje = '';\n      }\n    }\n  }\n\n  escribirMensaje() {\n    this.sockect.emit('escribiendoCita', {exe: true, _id: this.idCita});\n  }\n\n  cambiar() {\n    this.sockect.emit('escribiendoCita', {exe: false, _id: this.idCita});\n  }\n\n  recibirMensaje() {\n    const myobserver = new Observable(observer => {\n      this.sockect.on('mensajeCita', (data) => {\n        observer.next(data);\n         console.log(data);\n      });\n    });\n\n    return myobserver;\n  }\n\n  seleccionarMedia(url, type) {\n    this.urlInfo.url = url;\n    this.urlInfo.tipo = type;\n    this.modal('media');\n  }\n\n  async modal(type) {\n    const enterAnimation = (baseEl: any) => {\n      const backdropAnimation = this.animationCtrl.create()\n        .addElement(baseEl.querySelector('ion-backdrop'))\n        .fromTo('opacity', '0.01', 'var(--backdrop-opacity)');\n\n      const wrapperAnimation = this.animationCtrl.create()\n        .addElement(baseEl.querySelector('.modal-wrapper'))\n        .keyframes([\n          { offset: 0, opacity: '0', transform: 'scale(0)' },\n          { offset: 1, opacity: '0.99', transform: 'scale(1)' }\n        ]);\n\n      return this.animationCtrl.create()\n        .addElement(baseEl)\n        .easing('ease-out')\n        .duration(500)\n        .addAnimation([backdropAnimation, wrapperAnimation]);\n    }\n\n    const leaveAnimation = (baseEl: any) => {\n      return enterAnimation(baseEl).direction('reverse');\n    }\n    let data;\n    if (type === 'media') {\n      data = this.urlInfo;\n    } else {\n      data = this.dataInfoCita;\n    }\n    const modal = await this.modalCtrl.create({\n      component: ModalCitasPage,\n      componentProps: {\n        type,\n        data\n      },\n      mode: 'ios',\n      enterAnimation,\n      leaveAnimation\n    });\n\n    await modal.present();\n\n    const modalInfo: any = await modal.onWillDismiss();\n    if (modalInfo) {\n\n      if (modalInfo.data) {\n        if (modalInfo.data.estado) {\n          const data = {\n            listaTrabajos: modalInfo.data.info.trabajos,\n            estado: modalInfo.data.estado,\n            precio: modalInfo.data.info.precio\n          }\n          this.dataInfoCita.estado = modalInfo.data.estado;\n          // console.log(data);\n          this.almacenamiento.obtenerToken().then((info: any) => {\n            this.apiEstadoCitas.editarCita(info.token, this.idCita, data).subscribe((miCita: any) => {\n              // console.log('api', miCita);\n          \n              // console.log(miCita.response, ' Estado');\n            });\n          });\n        }\n      }\n    }\n  }\n\n\n\n\n  escribirOnCita() {\n    const myobserver = new Observable(observer => {\n      this.sockect.on('escribiendoCita', (data) => {\n        observer.next(data);\n      });\n    });\n\n    return myobserver;\n  }\n\n  async ubicacion() {\n    // console.log('Ubicacion');\n    const ok = await this.geo.getCurrentPosition();\n\n    if (ok) {\n      // console.log(ok);\n    }\n  }\n\n\n  // Camara\n\n  async camaraOpciones() {\n    const miHojaAccion = await this.actionSheet.create({\n      subHeader: '',\n      header: 'Selecciona cualquier opción para subir una foto, recuerda que solo puedes subir un vídeo por mensaje',\n\n      mode: 'md',\n      buttons: [\n        {\n          text: 'Tomar foto',\n          icon: 'camera-outline',\n          handler: () => {\n            this.tomarFoto(this.camera.PictureSourceType.CAMERA);\n          }\n        },\n\n        {\n          text: 'Grabar Vídeo',\n          icon: 'videocam-outline',\n          handler: () => {\n            if (!this.video) {\n              this.capturarVideo();\n            }\n          }\n        },\n        {\n          text: 'Seleccionar Imágen de galería',\n          icon: 'image-outline',\n          handler: () => {\n            this.tomarFoto(this.camera.PictureSourceType.PHOTOLIBRARY, 'image');\n          }\n        },\n        {\n          text: 'Seleccionar Vídeo de galería',\n          icon: 'image-outline',\n          handler: () => {\n            if (!this.video) {\n              this.tomarFoto(this.camera.PictureSourceType.PHOTOLIBRARY, 'video');\n            }\n          }\n        }\n      ]\n    });\n\n    return await miHojaAccion.present();\n  }\n\n  public tomarFoto(sourceType, mode?) {\n    const options: CameraOptions = {\n      quality: 80,\n      allowEdit: true,\n      correctOrientation: true,\n      destinationType: this.camera.DestinationType.FILE_URI,\n      mediaType: mode === 'image' ? this.camera.MediaType.PICTURE : this.camera.MediaType.VIDEO,\n      sourceType\n    };\n\n    this.camera.getPicture(options).then( async (imageData) => {\n       let mim = '';\n       let name = '';\n       // console.log('image data', imageData)\n       if (imageData.includes('jpg')){\n         mim = 'image/jpg';\n         name = 'image.jpg';\n       } else if (imageData.includes('png')) {\n        mim = 'image/png';\n        name = 'image.png';\n       } else if (imageData.includes('jpeg')) {\n        mim = 'image/jpeg';\n        name = 'image.jpeg';\n       } else if (imageData.includes('gif')) {\n        mim = 'image/gif';\n        name = 'image.gif';\n       } else {\n         name = 'video.mp4';\n         mim = 'video/mp4';\n       }\n       if (mim.includes('video') || mim.includes('Video')) {\n         this.video = true;\n       }\n       // console.log('Mi archivo', name, mim)\n       this.carreteArriba.push({path: imageData, name, mime: mim});\n       const url = window.Ionic.WebView.convertFileSrc( imageData );\n       this.carrete.push(url);\n       // console.log(this.carrete);\n       \n       this.camera.cleanup().then(() =>  console.log('Eliminado'));\n    });\n\n\n  }\n\n  capturarVideo() {\n    const opctions: CaptureVideoOptions = {\n      limit: 1,\n      duration: 30\n    }\n    this.media.captureVideo(opctions).then((url: MediaFile[]) => {\n       this.carreteArriba.push({path: url[0].fullPath, name: url[0].name, mime: url[0].type});\n       // console.log(url[0].name)\n       const image = window.Ionic.WebView.convertFileSrc( url[0].fullPath );\n       this.carrete.push(image);\n       this.video = true;\n       // console.log(this.carrete);\n    });\n  }\n\n  eliminardelCarrete(indice) {\n    this.carrete.splice(indice, 1);\n    this.carreteArriba.splice(indice, 1);\n\n    if (!this.carreteArriba.find(item => item.mime.includes('video') || item.mime.includes('Video') )) {\n        this.video = false;\n    }\n  }\n\n\n  verMensajes( event ) {\n      this.contenido.getScrollElement().then((e) => {\n        // console.log(' elemento ', e)\n      })\n  }\n\n\n  ionViewWillLeave() {\n    this.sockect.emit('salirChatCita', {\n      _id: this.idCita,\n    });\n\n    this.almacenamiento.eleminarCita().then((r) => {\n      if (r) {\n        return true;\n      }\n    });\n  }\n\n}\n","import { Directive, HostListener, ElementRef } from '@angular/core';\r\n\r\n@Directive({\r\n    selector: '[video-load]'\r\n})\r\n\r\nexport class VideoDirective {\r\n    \r\n    constructor(\r\n        private el: ElementRef\r\n    ) { }\r\n\r\n    @HostListener('canplay') cargando() {\r\n        this.el.nativeElement.currentTime = 0.3;\r\n    }\r\n}\r\n","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { ModalCitasPage } from './modal-citas.page';\nconst routes: Routes = [\n  {\n    path: '',\n    component: ModalCitasPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class ModalCitasPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { ModalCitasPageRoutingModule } from './modal-citas-routing.module';\n\nimport { ModalCitasPage } from './modal-citas.page';\nimport { ComponentsModule } from 'src/app/Components/components.module';\nimport { PipesModule } from 'src/app/pipes/pipes.module';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    ModalCitasPageRoutingModule,\n    ComponentsModule,\n    PipesModule\n  ],\n  declarations: [ModalCitasPage]\n})\nexport class ModalCitasPageModule {}\n","<ion-header *ngIf=\"vista === 'buscar'\">\n    <ion-toolbar color=\"blanco\">\n\n        <ion-title>Creando nuevas citas</ion-title>\n        <ion-buttons fill=\"clear\" slot=\"end\" *ngIf=\"type !== 'chat'\">\n            <ion-button (click)=\"descartar()\" fill=\"clear\">\n                <ion-icon name=\"close-outline\"></ion-icon>\n            </ion-button>\n        </ion-buttons>\n    </ion-toolbar>\n</ion-header>\n\n<ion-header *ngIf=\"vista === 'media'\">\n    <ion-toolbar color=\"dark\">\n        <ion-buttons fill=\"clear\" slot=\"start\">\n            <ion-button (click)=\"descartar()\" fill=\"clear\">\n                <ion-icon name=\"close-outline\"></ion-icon>\n            </ion-button>\n        </ion-buttons>\n        <ion-title>Fotos y Vídeos</ion-title>\n\n    </ion-toolbar>\n</ion-header>\n\n<ion-header *ngIf=\"vista === 'carpetas'\">\n    <ion-toolbar color=\"blanco\">\n        <ion-buttons fill=\"clear\" slot=\"start\">\n            <ion-button (click)=\"descartar()\" fill=\"clear\">\n                <ion-icon name=\"close-outline\"></ion-icon>\n            </ion-button>\n        </ion-buttons>\n        <ion-title>Carpeta de Citas</ion-title>\n\n    </ion-toolbar>\n</ion-header>\n\n<ion-content fullscreen=\"true\" *ngIf=\"vista === 'buscar' || vista === 'chat' || vista === 'setting'\">\n\n\n\n    <div class=\"divider\" *ngIf=\"vista === 'buscar'\">\n        <ion-slides #slide>\n            <ion-slide>\n                <ion-grid fixed>\n\n                    <ion-row>\n                        <ion-col size=\"12\">\n                            <ion-searchbar color=\"light\"></ion-searchbar>\n                        </ion-col>\n\n                        <ion-col size=\"12\">\n                            <div class=\"divider\"></div>\n                        </ion-col>\n                    </ion-row>\n\n                    <ion-row>\n                        <ion-col size=\"12\">\n                            <ion-list>\n                                <ion-item *ngFor=\"let taller of listaTalleres\" (press)=\"opciones(taller.usuarioReceptor.nombrecompleto)\" (click)=\"crear(taller)\">\n                                    <ion-avatar slot=\"start\">\n                                        <img src=\"https://motocaliapp.com/{{taller.avatar}}\" width=\"100%\" alt=\"\">\n                                    </ion-avatar>\n                                    <ion-label class=\"ion-text-wrap\">\n                                        <div>{{ taller.usuarioReceptor.nombrecompleto }}</div>\n                                        <div>{{ taller.usuarioReceptor.nombreusuario }}</div>\n                                    </ion-label>\n\n                                </ion-item>\n                            </ion-list>\n\n                        </ion-col>\n                    </ion-row>\n\n                </ion-grid>\n            </ion-slide>\n\n            <ion-slide class=\"anchofull\">\n                <ion-grid fixed>\n                    <ion-row>\n                        <ion-col size=\"12\">\n                            <h3 class=\"opacity\">Creando un nuevo turno para {{usuario}}</h3>\n                        </ion-col>\n                    </ion-row>\n                    <ion-row>\n                        <ion-col size=\"6\">\n                            <ion-button expand=\"block\" mode=\"ios\" color=\"light\" (click)=\"cancelar()\">Cancelar </ion-button>\n\n                        </ion-col>\n\n                        <ion-col size=\"6\">\n                            <ion-button expand=\"block\" mode=\"ios\" color=\"primary\" (click)=\"generarTicket()\">Generar </ion-button>\n\n                        </ion-col>\n                    </ion-row>\n                </ion-grid>\n            </ion-slide>\n        </ion-slides>\n    </div>\n\n\n\n    <div>\n\n\n\n    </div>\n\n</ion-content>\n\n<ion-content fullscreen=\"true\" *ngIf=\"vista === 'media'\" color=\"darkgold\">\n\n    <app-video *ngIf=\"tipoArchivo === 'video'\" url=\"https://motocaliapp.com/Citas/{{ urlArchivo }}\"></app-video>\n\n    <ion-slides class=\"diapositiva\" [options]=\"slideOpt\" *ngIf=\"tipoArchivo === 'imagen'\">\n        <ion-slide>\n            <img src=\"https://motocaliapp.com/Citas/{{ urlArchivo }}\" alt=\"\">\n        </ion-slide>\n    </ion-slides>\n</ion-content>\n\n\n<ion-content fullscreen=\"true\" *ngIf=\"vista === 'carpetas'\">\n    <div class=\"divider \">\n        <ion-searchbar mode=\"ios\" (ionChange)=\"filtro( $event )\"></ion-searchbar>\n    </div>\n    <ion-list>\n        <ion-item-sliding *ngFor=\"let cita of citas | miFiltro : texto\">\n            <ion-item (click)=\"escogerChat(cita._id)\">\n                <ion-avatar class=\"avatar\" slot=\"start\">\n                    <img src=\"https://motocaliapp.com/{{cita.imagenTaller}}\" width=\"100%\" />\n                </ion-avatar>\n                <ion-label class=\"ion-text-wrap\">\n                    <strong class=\"medium\">{{ cita.nombrecompleto }}</strong>\n                    <p>@{{ cita.nombreusuario }} - Estado pendiente</p>Cita creada el {{ cita.fechainicio | fecha }}\n                </ion-label>\n                <div slot=\"end\" class=\"estadobol\" [ngClass]=\"{'estado-amarillo ': cita.estado === 'PENDIENTE', 'estado-azul ': cita.estado === 'EN PROGRESO', 'estado-verde ': cita.estado === 'TERMINADO'}\">\n\n                </div>\n            </ion-item>\n            <ion-item-options side=\"start\">\n                <ion-item-option color=\"light\">\n                    <ion-icon slot=\"icon-only\" name=\"ellipsis-vertical-outline\"></ion-icon>\n                </ion-item-option>\n                <ion-item-option color=\"secondary\">\n                    <ion-icon slot=\"icon-only\" name=\"trash-outline\"></ion-icon>\n                </ion-item-option>\n            </ion-item-options>\n        </ion-item-sliding>\n    </ion-list>\n</ion-content>","import { Component, OnInit, Input, ViewChild, ElementRef } from '@angular/core';\nimport { ModalController, ActionSheetController, IonSlides, AnimationController } from '@ionic/angular';\nimport { EstadoCitasService } from 'src/app/providers/Api/EstadoCitas.service';\nimport { ToastServices } from '../../../providers/Utilidades/ToastService.service';\nimport { InicioService } from 'src/app/providers/Almacenamiento/inicio.service';\nimport * as moment from 'moment';\nimport { trigger, transition, animate, style } from '@angular/animations';\nmoment.locale('es');\n\n@Component({\n  selector: 'app-modal-citas',\n  templateUrl: './modal-citas.page.html',\n  styleUrls: ['./modal-citas.page.scss'],\n  animations: [\n    trigger('entrada', [\n      transition(':enter', [\n        style({\n          opacity: 0,\n          transform: 'scale(0)'\n        }),\n        animate('250ms', style({\n          opacity: 1,\n          transform: 'scale(1)'\n        }))\n      ]),\n\n      transition(':leave', [\n        style({\n          opacity: 1,\n          transform: 'scale(1)'\n        }),\n        animate('250ms', style({\n          opacity: 0,\n          transform: 'scale(0)'\n        }))\n      ])\n    ])\n  ]\n})\nexport class ModalCitasPage implements OnInit {\n\n  \n  @Input() type: any;\n  @Input() data: any;\n  \n\n  titulo = 'Configuración';\n  vista;\n  @ViewChild('slide', {static: false}) slide: IonSlides;\n  listaTalleres = [];\n  mensaje = '';\n  estado = '';\n  estadoCambio = '';\n  role = '';\n\n  \n  usuario  = '';\n  taller: any;\n\n  urlArchivo: any = '';\n  tipoArchivo: any = '';\n\n  slideOpt = {\n    zoom: {\n      maxRatio: 3,\n      minRatio: 1,\n      toggle: true\n    }\n  };\n\n  citas = [];\n  texto = '';\n\n\n  // Sistema de Trabajos en el local\n\n  listaCreados = [];\n  trabajos = [];\n  nuevoTrabajo = false;\n  textoTrabajo = '';\n  textoBuscar = '';\n\n  precioconfig = false;\n  precio = 0;\n  msgEstado = '';\n  msgpro = '';\n  msgter = '';\n  terminado = false;\n\n  constructor(\n    private modalCtrl: ModalController,\n    private actionSheetCtrl: ActionSheetController,\n    private citasService: EstadoCitasService,\n    private utitlities: ToastServices,\n    private almacenamiento: InicioService,\n    private animationCtrl: AnimationController,\n    private toast: ToastServices\n  ) { \n    \n  }\n\n  ngOnInit() {\n  }\n\n   async ionViewWillEnter() {\n    \n    switch (this.type) {\n      case 'setting':\n        const ui = await this.almacenamiento.obtenerToken();\n\n        if (ui) {\n          this.citasService.obtenerListaTrabajos(ui.token).subscribe((res: any) => {\n            console.log(res, 'Respuesta');\n            if (res.exe) {\n              this.listaCreados = res.response[0].listaTrabajos;\n            }\n            \n          })\n          console.log(1)\n        }\n        console.log(2)\n        this.vista = 'setting';\n        break;\n\n      case 'buscar':\n        this.titulo = 'Buscar Talleres';\n        this.vista = 'buscar';\n        setTimeout(() => {\n          this.slide.lockSwipes(true).then(() => {\n            console.log('OK')\n          })\n        }, 500);\n\n        this.listarTalleres();\n\n        break;\n          case 'media':\n            this.vista = 'media';\n            this.urlArchivo = this.data.url;\n            this.tipoArchivo = this.data.tipo;\n            break;\n\n            case 'carpetas':\n            this.vista = 'carpetas';\n            console.log(this.data, 'BUENA ESA VALLE')\n            if (this.data.role === 'TALLER_ROLE') {\n              const filtrado = this.data.info.filter((item) => item.usuariopedido._id === this.data.unico)\n              this.citas = filtrado;\n            } else {\n              const filtrado = this.data.info.filter((item) => item.idtaller._id === this.data.unico)\n              this.citas = filtrado;\n            }\n            \n            break;\n\n      default:\n        break;\n\n    }\n  }\n\n  filtro ( event ) {\n    this.texto = event.detail.value;\n  }\n\n  \n\n\n\n  async guardar() {\n    \n      const usuario = await this.almacenamiento.obtenerToken();\n  \n      if (usuario) {\n            this.modalCtrl.dismiss({\n              estado: this.estadoCambio,\n              info: {\n                trabajos: this.trabajos,\n                precio: this.precio\n              }\n            });\n            this.nuevoTrabajo = false;\n      }\n  }\n\n  escogerChat(cita) {\n    this.modalCtrl.dismiss({\n      salir: true,\n      cita\n    })\n  }\n\n  descartar() {\n    this.modalCtrl.dismiss({\n      salir: true\n    })\n  }\n\n \n  listarTalleres() {\n    this.almacenamiento.obtenerToken().then((info: any) => {\n      this.citasService.listadoTalleres(info.token).subscribe((data: any) => {\n\n        if (data.response.length > 0) {\n            data.response.forEach((item) => {\n              item.avatar = item.usuarioReceptor.imagen[0].path;\n              this.listaTalleres.push(item);\n            });\n        }\n        console.log(this.listaTalleres, data);\n      })\n    })\n  }\n\n  async opciones(usuario) {\n    await this.slide.lockSwipes(true);\n    const actionSheet = await this.actionSheetCtrl.create({\n      translucent: true,\n      header: `Que quieres hacer con ${usuario}`,\n      buttons: [\n        {\n          text: 'Compartir Perfíl',\n          icon: 'arrow-redo-outline',\n          handler: () => {\n\n          }\n        },\n        {\n          text: 'Enviar mensaje',\n          icon: 'chatbubble-outline',\n          handler: () => {\n\n          }\n        },\n        {\n          text: 'Invitar a grupo',\n          icon: 'people-outline',\n          handler: () => {\n\n          }\n        },\n        {\n          text: 'Eliminar Usuario',\n          icon: 'trash-outline',\n          cssClass: 'eliminar',\n          handler: () => {\n\n          }\n        },\n        {\n          text: 'Cancelar',\n          role: 'cancel',\n          icon: 'close-outline'\n        }\n      ]\n    })\n\n    return await actionSheet.present();\n  }\n\n  async crear( item ) {\n    await this.slide.lockSwipes(false);\n    await this.slide.slideNext(300);\n    this.usuario = item.usuarioReceptor.nombrecompleto;\n    this.taller = item;\n    await this.slide.lockSwipes(true);\n  }\n\n  generarTicket() {\n    console.log('Taller', this.taller.usuarioReceptor._id);\n    this.almacenamiento.obtenerToken().then((info: any) => {\n      this.citasService.crearCita(info.token, {idtaller: this.taller.usuarioReceptor._id}).subscribe(async (data) => {\n\n        console.log(data);\n        await this.modalCtrl.dismiss({});\n  \n      }, async (error) => {\n        await this.utitlities.alertApplication('No se pudo agendar la cita', false);\n        await this.modalCtrl.dismiss({});\n      });\n    })\n  }\n\n  async cancelar() {\n    await this.slide.lockSwipes(false);\n    await this.slide.slidePrev(300);\n    await this.slide.lockSwipes(true);\n  }\n\n\n  // CONFIGURACIONES\n\n\n  filtroTrabajo( event ) {\n    this.textoBuscar = event.detail.value;\n  }\n\n\n\n  check( trabajo ): boolean {\n    return this.trabajos.find((item) => item === trabajo)\n  }\n\n  borrarTrabajo ( i: number ) {\n    this.trabajos.splice(i, 1);\n  }\n\n  habilitarTrabajo() {\n      this.nuevoTrabajo = true;\n  }\n}"]}